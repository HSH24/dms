<?xml version="1.0" encoding="GB2312"?>
<!DOCTYPE sqlMap
	PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
	"http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="sale">
	
	<typeAlias alias="sale" type="com.hsh24.dms.api.sale.bo.Sale" />
	
	<select id="getStats" parameterClass="sale" resultClass="sale">
	<![CDATA[
		SELECT SUM(og.goods_num * og.goods_fact_price) AS amount
		  FROM oms.ord_order_goods_t og,
			   oms.main_goods_v gv,
			   oms.`ord_order_t` qq
		 WHERE og.create_dt >= date_format( #gmtStart#, '%Y-%m-%d %T')
		   AND og.create_dt <= date_format( #gmtEnd#, '%Y-%m-%d %T')
		   AND og.goods_id = gv.goods_id
		   AND og.goods_mode = gv.goods_mode
		   AND(og.goods_spec_id = '' OR og.goods_spec_id = gv.goods_spec_id)
		   AND og.`order_id` = qq.order_id
		   AND qq.order_status = '0005'
		   AND qq.org_id = #shopId#
	]]>
	</select>
	
	<select id="getSaleList" parameterClass="sale" resultClass="sale">
	<![CDATA[
		SELECT (og.goods_num * og.goods_fact_price) AS amount,
			   gv.goods_nm AS itemName,
			   gv.goods_unit_nm AS unit,
			   og.goods_num AS quantity
		  FROM oms.ord_order_goods_t og,
			   oms.main_goods_v gv,
			   oms.`ord_order_t` qq
		 WHERE og.goods_id = gv.goods_id
		   AND og.goods_mode = gv.goods_mode
		   AND (og.goods_spec_id = '' OR og.goods_spec_id = gv.goods_spec_id)
		   AND og.`order_id` = qq.order_id
		   AND qq.order_status = '0005'
		   AND qq.org_id = #shopId#
		  ORDER BY qq.`order_dt` DESC
	]]>
	</select>
	
</sqlMap>