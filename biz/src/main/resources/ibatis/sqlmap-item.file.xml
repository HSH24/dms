<?xml version="1.0" encoding="GB2312"?>
<!DOCTYPE sqlMap
	PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
	"http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="item.file">
	
	<typeAlias alias="itemFile" type="com.hsh24.dms.api.item.bo.ItemFile" />
	
	<select id="getItemFileList" parameterClass="itemFile" resultClass="itemFile">
	<![CDATA[
		SELECT q.id,
		  t.item_id   AS itemId,
		  p.file_id   AS fileId,
		  p.file_path AS filePath
		FROM dms_tb_item t,
		  dms_tb_file p,
		  dms_tb_item_file q
		WHERE t.item_id = q.item_id
		AND p.file_id   = q.file_id
		AND t.state     = 'U'
		AND p.state     = 'U'
		AND q.state     = 'U'
	]]>
		<dynamic>
			<isNotEmpty property="supId">
			<![CDATA[
				AND t.sup_id    = #supId#
				AND p.sup_id    = #supId#
			]]>
			</isNotEmpty>
		</dynamic>
	<![CDATA[
		AND t.item_id   = #itemId#
	]]>
	</select>
	
</sqlMap>